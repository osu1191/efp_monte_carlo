EFPMD ver. 1.8.0
Copyright (c) 2012-2017 Ilya Kaliman

LIBEFP ver. 1.8.0
Copyright (c) 2012-2017 Ilya Kaliman
              2018-2022 Lyudmila Slipchenko

Journal References:
  - Kaliman and Slipchenko, JCC 2013.
    DOI: http://dx.doi.org/10.1002/jcc.23375
  - Kaliman and Slipchenko, JCC 2015.
    DOI: http://dx.doi.org/10.1002/jcc.23772

Project web site: https://github.com/libefp2/libefp/

RUNNING 1 MPI PROCESSES WITH 1 OPENMP THREADS EACH
WALL CLOCK TIME IS Tue Oct  8 04:35:53 2024

SIMULATION SETTINGS

run_type opt
coord atoms
terms qq lj
special_terms qq lj
elec_damp off
disp_damp off
pol_damp tt
pol_driver iterative
enable_ff false
enable_multistep false
ff_geometry ff.xyz
ff_parameters /../fraglib/params/amber99.prm
single_params_file false
efp_params_file params.efp
enable_cutoff false
swf_cutoff 10
xr_cutoff 0
max_steps 20
multistep_steps 1
fraglib_path ../fraglib
userlib_path .
enable_pbc false
periodic_box 30.0 30.0 30.0 90.0 90.0 90.0
opt_tol 0.0003
opt_energy_tol 1e-06
gtest_tol 1e-06
ref_energy 0
hess_central false
num_step_dist 0.001
num_step_angle 0.01
ensemble nve
time_step 1
print_step 1
velocitize false
temperature 300
pressure 1
thermostat_tau 1000
barostat_tau 10000
ligand -100
enable_pairwise false
print_pbc false
symmetry false
special_fragment 0
enable_torch true
apply_elpot true
opt_special_frag 0
torch_nn ani1.pt
atom_gradient mm
symm_frag frag
update_params 0
update_params_cutoff 0
print 0


xr_cutoff is set to 10.000000 

testing state->torch : printing nn_type = 
testing state->torch : printing natoms = 
testing state->torch : printing energy = 
    A01O  -1.81522000   2.66398800  -0.00000000   0.03093847
    A02H  -1.61748000   1.72546100   0.00193600   0.01629609
    A03H  -2.47602600   2.73690600  -0.71490800   0.03012761

Testing elpot printing
    0.030938
    0.016296
    0.030128
Done testing elpot

SPECIAL FRAGMENT ENERGY MINIMIZATION JOB


Inside opt_set_func


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8152  2.6640 -0.0000
 -1.6175  1.7255  0.0019
 -2.4760  2.7369 -0.7149
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 2.3373
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 -0.0895 -0.1161 -0.1260
 -0.0099  0.1087  0.0142
  0.0994  0.0075  0.1118
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0233726
Custom energy in wrapper 0.0233726
Energy in torch_custom2 =     0.023373 
Gradients:
0.089514	0.116135	0.125984	
0.009899	-0.108651	-0.014164	
-0.099413	-0.007484	-0.111820	
Forces:
-0.089514	-0.116135	-0.125984	
-0.009899	0.108651	0.014164	
0.099413	0.007484	0.111820	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.815220          2.663988        -0.000000
   1         -1.617480          1.725461         0.001936
   1         -2.476026          2.736906        -0.714908
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.047369          0.061456         0.066668
   2          0.005238         -0.057496        -0.007495
   3         -0.052607         -0.003960        -0.059173
------------------------------------------------------------

 Torch energy 0.023373 

================= END OF TEST FOR CUSTOM MODEL=====================

marker for calling in opt_get_fx
marker for calling in opt_get_gx
    INITIAL STATE

    GEOMETRY (ANGSTROMS)

A01O                -1.815220     2.663988    -0.000000
A02H                -1.617480     1.725461     0.001936
A03H                -2.476026     2.736906    -0.714908
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0058237165
                     LJ ENERGY     0.0002791012

                     ML ENERGY     0.0233725794

                  TOTAL ENERGY     0.0178279640


                 ENERGY CHANGE     0.0000000000
                  RMS GRADIENT     0.0460517583
              MAXIMUM GRADIENT     0.0687283607


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.9957  2.4579 -0.2633
 -1.6365  1.9386  0.0325
 -2.2796  2.7374 -0.4904
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy:  0.4806
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 -0.0970  1.1641 -0.1314
  0.3697 -0.9310  0.3244
 -0.2727 -0.2331 -0.1930
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.480593
Custom energy in wrapper 0.480593
Energy in torch_custom2 =     0.480593 
Gradients:
0.096978	-1.164071	0.131359	
-0.369706	0.931011	-0.324356	
0.272727	0.233060	0.192997	
Forces:
-0.096978	1.164071	-0.131359	
0.369706	-0.931011	0.324356	
-0.272727	-0.233060	-0.192997	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.995698          2.457932        -0.263251
   1         -1.636531          1.938575         0.032485
   1         -2.279595          2.737386        -0.490415
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.051319         -0.616000         0.069512
   2         -0.195640          0.492670        -0.171642
   3          0.144321          0.123330         0.102130
------------------------------------------------------------

 Torch energy 0.480593 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8263  2.6513 -0.0162
 -1.6187  1.7386  0.0038
 -2.4639  2.7369 -0.7011
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.6590
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -4.2279 -4.0632 -5.6042
  -0.3071  3.8559  0.5455
   4.5351  0.2072  5.0587
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0165899
Custom energy in wrapper 0.0165899
Energy in torch_custom2 =     0.016590 
Gradients:
0.042279	0.040632	0.056042	
0.003071	-0.038559	-0.005455	
-0.045351	-0.002072	-0.050587	
Forces:
-0.042279	-0.040632	-0.056042	
-0.003071	0.038559	0.005455	
0.045351	0.002072	0.050587	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.826331          2.651303        -0.016207
   1         -1.618653          1.738581         0.003817
   1         -2.463933          2.736936        -0.701087
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.022373          0.021501         0.029656
   2          0.001625         -0.020405        -0.002887
   3         -0.023998         -0.001097        -0.026769
------------------------------------------------------------

 Torch energy 0.016590 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 1 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.826331     2.651303    -0.016207
A02H                -1.618653     1.738581     0.003817
A03H                -2.463933     2.736936    -0.701087
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0055533356
                     LJ ENERGY     0.0002269038

                     ML ENERGY     0.0165899321

                  TOTAL ENERGY     0.0112635003


                 ENERGY CHANGE    -0.0065644637
                  RMS GRADIENT     0.0189855779
              MAXIMUM GRADIENT     0.0316101550


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8362  2.6475 -0.0302
 -1.6191  1.7453  0.0052
 -2.4541  2.7351 -0.6896
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5900
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
  2.9091 -1.6826  2.8186
  -0.2396  1.2239  0.0123
  -2.6694  0.4586 -2.8309
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0159002
Custom energy in wrapper 0.0159002
Energy in torch_custom2 =     0.015900 
Gradients:
-0.029091	0.016826	-0.028186	
0.002396	-0.012239	-0.000123	
0.026694	-0.004586	0.028309	
Forces:
0.029091	-0.016826	0.028186	
-0.002396	0.012239	0.000123	
-0.026694	0.004586	-0.028309	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.836185          2.647499        -0.030182
   1         -1.619058          1.745281         0.005246
   1         -2.454099          2.735108        -0.689650
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1         -0.015394          0.008904        -0.014915
   2          0.001268         -0.006477        -0.000065
   3          0.014126         -0.002427         0.014980
------------------------------------------------------------

 Torch energy 0.015900 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 2 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.836185     2.647499    -0.030182
A02H                -1.619058     1.745281     0.005246
A03H                -2.454099     2.735108    -0.689650
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0054820332
                     LJ ENERGY     0.0002114266

                     ML ENERGY     0.0159001686

                  TOTAL ENERGY     0.0106295620


                 ENERGY CHANGE    -0.0006339383
                  RMS GRADIENT     0.0101224410
              MAXIMUM GRADIENT     0.0157181445


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8322  2.6472 -0.0264
 -1.6193  1.7458  0.0052
 -2.4580  2.7351 -0.6937
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5673
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.001 *
  1.0890 -9.1282 -0.8519
   0.5897  6.0010  1.9935
  -1.6788  3.1272 -1.1416
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0156728
Custom energy in wrapper 0.0156728
Energy in torch_custom2 =     0.015673 
Gradients:
-0.001089	0.009128	0.000852	
-0.000590	-0.006001	-0.001994	
0.001679	-0.003127	0.001142	
Forces:
0.001089	-0.009128	-0.000852	
0.000590	0.006001	0.001994	
-0.001679	0.003127	-0.001142	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.832198          2.647223        -0.026364
   1         -1.619250          1.745823         0.005236
   1         -2.457983          2.735083        -0.693699
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1         -0.000576          0.004830         0.000451
   2         -0.000312         -0.003176        -0.001055
   3          0.000888         -0.001655         0.000604
------------------------------------------------------------

 Torch energy 0.015673 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 3 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.832198     2.647223    -0.026364
A02H                -1.619250     1.745823     0.005236
A03H                -2.457983     2.735083    -0.693699
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0054778996
                     LJ ENERGY     0.0002106466

                     ML ENERGY     0.0156728476

                  TOTAL ENERGY     0.0104055945


                 ENERGY CHANGE    -0.0002239674
                  RMS GRADIENT     0.0018258825
              MAXIMUM GRADIENT     0.0028624997


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8319  2.6480 -0.0270
 -1.6191  1.7462  0.0057
 -2.4587  2.7345 -0.6941
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5676
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.001 *
  0.3023 -10.0278 -1.8973
   0.6089  6.7386  2.1642
  -0.9112  3.2892 -0.2669
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.015676
Custom energy in wrapper 0.015676
Energy in torch_custom2 =     0.015676 
Gradients:
-0.000302	0.010028	0.001897	
-0.000609	-0.006739	-0.002164	
0.000911	-0.003289	0.000267	
Forces:
0.000302	-0.010028	-0.001897	
0.000609	0.006739	0.002164	
-0.000911	0.003289	-0.000267	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.831875          2.647955        -0.026952
   1         -1.619102          1.746243         0.005667
   1         -2.458663          2.734466        -0.694085
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1         -0.000160          0.005306         0.001004
   2         -0.000322         -0.003566        -0.001145
   3          0.000482         -0.001741         0.000141
------------------------------------------------------------

 Torch energy 0.015676 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8306  2.6509 -0.0293
 -1.6185  1.7479  0.0074
 -2.4614  2.7320 -0.6956
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5697
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.001 *
 -2.7952 -13.9160 -6.0062
   0.6478  9.9274  2.8257
   2.1474  3.9886  3.1806
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0156975
Custom energy in wrapper 0.0156975
Energy in torch_custom2 =     0.015697 
Gradients:
0.002795	0.013916	0.006006	
-0.000648	-0.009927	-0.002826	
-0.002147	-0.003989	-0.003181	
Forces:
-0.002795	-0.013916	-0.006006	
0.000648	0.009927	0.002826	
0.002147	0.003989	0.003181	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.830581          2.650883        -0.029304
   1         -1.618511          1.747922         0.007390
   1         -2.461383          2.732000        -0.695630
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.001479          0.007364         0.003178
   2         -0.000343         -0.005253        -0.001495
   3         -0.001136         -0.002111        -0.001683
------------------------------------------------------------

 Torch energy 0.015697 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 4 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.830581     2.650883    -0.029304
A02H                -1.618511     1.747922     0.007390
A03H                -2.461383     2.732000    -0.695630
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0055845865
                     LJ ENERGY     0.0002248108

                     ML ENERGY     0.0156974662

                  TOTAL ENERGY     0.0103376906


                 ENERGY CHANGE    -0.0000679040
                  RMS GRADIENT     0.0022899811
              MAXIMUM GRADIENT     0.0050623044


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8235  2.6682 -0.0491
 -1.6144  1.7630  0.0202
 -2.4786  2.7149 -0.7041
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5894
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -1.6028 -2.8953 -2.0747
   0.1371  2.1304  0.4729
   1.4657  0.7649  1.6018
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0158943
Custom energy in wrapper 0.0158943
Energy in torch_custom2 =     0.015894 
Gradients:
0.016028	0.028953	0.020747	
-0.001371	-0.021304	-0.004729	
-0.014657	-0.007649	-0.016018	
Forces:
-0.016028	-0.028953	-0.020747	
0.001371	0.021304	0.004729	
0.014657	0.007649	0.016018	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.823472          2.668221        -0.049143
   1         -1.614416          1.763010         0.020179
   1         -2.478550          2.714917        -0.704101
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.008482          0.015321         0.010979
   2         -0.000726         -0.011274        -0.002503
   3         -0.007756         -0.004048        -0.008476
------------------------------------------------------------

 Torch energy 0.015894 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 5 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.823472     2.668221    -0.049143
A02H                -1.614416     1.763010     0.020179
A03H                -2.478550     2.714917    -0.704101
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0061150481
                     LJ ENERGY     0.0002956111

                     ML ENERGY     0.0158942938

                  TOTAL ENERGY     0.0100748568


                 ENERGY CHANGE    -0.0002628338
                  RMS GRADIENT     0.0073873555
              MAXIMUM GRADIENT     0.0127781900


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8168  2.6864 -0.0760
 -1.6092  1.7844  0.0363
 -2.4978  2.6945 -0.7127
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.6110
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -2.9082 -3.5290 -3.0427
   0.2925  2.4314  0.4946
   2.6158  1.0976  2.5481
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0161103
Custom energy in wrapper 0.0161103
Energy in torch_custom2 =     0.016110 
Gradients:
0.029082	0.035290	0.030427	
-0.002925	-0.024314	-0.004946	
-0.026158	-0.010976	-0.025481	
Forces:
-0.029082	-0.035290	-0.030427	
0.002925	0.024314	0.004946	
0.026158	0.010976	0.025481	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.816843          2.686434        -0.076033
   1         -1.609239          1.784385         0.036332
   1         -2.497791          2.694517        -0.712658
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.015390          0.018675         0.016101
   2         -0.001548         -0.012866        -0.002618
   3         -0.013842         -0.005808        -0.013484
------------------------------------------------------------

 Torch energy 0.016110 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 6 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.816843     2.686434    -0.076033
A02H                -1.609239     1.784385     0.036332
A03H                -2.497791     2.694517    -0.712658
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0066926496
                     LJ ENERGY     0.0003765744

                     ML ENERGY     0.0161102787

                  TOTAL ENERGY     0.0097942034


                 ENERGY CHANGE    -0.0002806533
                  RMS GRADIENT     0.0111968885
              MAXIMUM GRADIENT     0.0177727175


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8129  2.7071 -0.1141
 -1.6015  1.8150  0.0578
 -2.5195  2.6693 -0.7219
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.6145
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -3.2011 -3.8791 -2.7934
   0.2988  2.5762  0.2848
   2.9023  1.3029  2.5086
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0161446
Custom energy in wrapper 0.0161446
Energy in torch_custom2 =     0.016145 
Gradients:
0.032011	0.038791	0.027934	
-0.002988	-0.025762	-0.002848	
-0.029023	-0.013029	-0.025086	
Forces:
-0.032011	-0.038791	-0.027934	
0.002988	0.025762	0.002848	
0.029023	0.013029	0.025086	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.812864          2.707107        -0.114136
   1         -1.601524          1.815041         0.057790
   1         -2.519542          2.669299        -0.721906
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.016939          0.020527         0.014782
   2         -0.001581         -0.013633        -0.001507
   3         -0.015358         -0.006894        -0.013275
------------------------------------------------------------

 Torch energy 0.016145 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 7 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.812864     2.707107    -0.114136
A02H                -1.601524     1.815041     0.057790
A03H                -2.519542     2.669299    -0.721906
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0073540262
                     LJ ENERGY     0.0004758869

                     ML ENERGY     0.0161446147

                  TOTAL ENERGY     0.0092664754


                 ENERGY CHANGE    -0.0005277280
                  RMS GRADIENT     0.0116643312
              MAXIMUM GRADIENT     0.0166961805


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8243  2.7320 -0.1770
 -1.5818  1.9112  0.0909
 -2.5546  2.6212 -0.7574
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.7455
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -6.6997  6.2062 -5.9580
   1.9700 -6.8599  2.1934
   4.7297  0.6538  3.7646
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0174545
Custom energy in wrapper 0.0174545
Energy in torch_custom2 =     0.017455 
Gradients:
0.066997	-0.062062	0.059580	
-0.019700	0.068599	-0.021934	
-0.047297	-0.006538	-0.037646	
Forces:
-0.066997	0.062062	-0.059580	
0.019700	-0.068599	0.021934	
0.047297	0.006538	0.037646	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.824315          2.731974        -0.176977
   1         -1.581844          1.911242         0.090919
   1         -2.554614          2.621195        -0.757392
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.035453         -0.032842         0.031528
   2         -0.010425          0.036301        -0.011607
   3         -0.025029         -0.003460        -0.019921
------------------------------------------------------------

 Torch energy 0.017455 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8162  2.7144 -0.1326
 -1.5957  1.8433  0.0675
 -2.5299  2.6552 -0.7323
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.6057
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -4.2120  0.0455 -3.5463
   0.9012 -1.0853  0.7767
   3.3108  1.0397  2.7696
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0160567
Custom energy in wrapper 0.0160567
Energy in torch_custom2 =     0.016057 
Gradients:
0.042120	-0.000455	0.035463	
-0.009012	0.010853	-0.007767	
-0.033108	-0.010397	-0.027696	
Forces:
-0.042120	0.000455	-0.035463	
0.009012	-0.010853	0.007767	
0.033108	0.010397	0.027696	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.816232          2.714421        -0.132618
   1         -1.595736          1.843335         0.067534
   1         -2.529857          2.655151        -0.732343
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.022289         -0.000241         0.018766
   2         -0.004769          0.005743        -0.004110
   3         -0.017520         -0.005502        -0.014656
------------------------------------------------------------

 Torch energy 0.016057 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 8 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.816232     2.714421    -0.132618
A02H                -1.595736     1.843335     0.067534
A03H                -2.529857     2.655151    -0.732343
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0075784547
                     LJ ENERGY     0.0005119127

                     ML ENERGY     0.0160567295

                  TOTAL ENERGY     0.0089901875


                 ENERGY CHANGE    -0.0002762879
                  RMS GRADIENT     0.0130566732
              MAXIMUM GRADIENT     0.0220275110


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8200  2.7468 -0.1978
 -1.5804  1.8983  0.1024
 -2.5595  2.6155 -0.7476
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5939
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -2.5020 -3.0375 -1.5045
  -0.1668  2.0809 -0.4135
   2.6688  0.9566  1.9180
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0159386
Custom energy in wrapper 0.0159386
Energy in torch_custom2 =     0.015939 
Gradients:
0.025020	0.030375	0.015045	
0.001668	-0.020809	0.004135	
-0.026688	-0.009566	-0.019180	
Forces:
-0.025020	-0.030375	-0.015045	
-0.001668	0.020809	-0.004135	
0.026688	0.009566	0.019180	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.819967          2.746833        -0.197838
   1         -1.580445          1.898340         0.102443
   1         -2.559484          2.615483        -0.747645
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.013240          0.016074         0.007962
   2          0.000883         -0.011011         0.002188
   3         -0.014123         -0.005062        -0.010149
------------------------------------------------------------

 Torch energy 0.015939 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 9 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.819967     2.746833    -0.197838
A02H                -1.580445     1.898340     0.102443
A03H                -2.559484     2.615483    -0.747645
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0085382886
                     LJ ENERGY     0.0006865629

                     ML ENERGY     0.0159385912

                  TOTAL ENERGY     0.0080868655


                 ENERGY CHANGE    -0.0009033220
                  RMS GRADIENT     0.0086072979
              MAXIMUM GRADIENT     0.0129520720


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8321  2.7611 -0.2336
 -1.5714  1.9365  0.1186
 -2.5680  2.5949 -0.7562
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5791
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
  1.2762 -2.4497  1.4239
  -0.8125  2.5582 -1.0953
  -0.4637 -0.1085 -0.3286
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0157909
Custom energy in wrapper 0.0157909
Energy in torch_custom2 =     0.015791 
Gradients:
-0.012762	0.024497	-0.014239	
0.008125	-0.025582	0.010953	
0.004637	0.001085	0.003286	
Forces:
0.012762	-0.024497	0.014239	
-0.008125	0.025582	-0.010953	
-0.004637	-0.001085	-0.003286	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.832141          2.761055        -0.233592
   1         -1.571374          1.936518         0.118587
   1         -2.567988          2.594913        -0.756226
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1         -0.006753          0.012963        -0.007535
   2          0.004300         -0.013538         0.005796
   3          0.002454          0.000574         0.001739
------------------------------------------------------------

 Torch energy 0.015791 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 10 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.832141     2.761055    -0.233592
A02H                -1.571374     1.936518     0.118587
A03H                -2.567988     2.594913    -0.756226
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0088992786
                     LJ ENERGY     0.0007647097

                     ML ENERGY     0.0157908946

                  TOTAL ENERGY     0.0076563257


                 ENERGY CHANGE    -0.0004305398
                  RMS GRADIENT     0.0060300290
              MAXIMUM GRADIENT     0.0113518276


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8389  2.7873 -0.2850
 -1.5587  1.9958  0.1441
 -2.5918  2.5582 -0.7743
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.6286
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
  0.1147 -5.8138  1.7219
  -1.9592  5.3288 -2.9423
   1.8445  0.4850  1.2203
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0162857
Custom energy in wrapper 0.0162857
Energy in torch_custom2 =     0.016286 
Gradients:
-0.001147	0.058138	-0.017219	
0.019592	-0.053288	0.029423	
-0.018445	-0.004850	-0.012203	
Forces:
0.001147	-0.058138	0.017219	
-0.019592	0.053288	-0.029423	
0.018445	0.004850	0.012203	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.838940          2.787280        -0.284992
   1         -1.558741          1.995814         0.144072
   1         -2.591753          2.558168        -0.774287
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1         -0.000607          0.030765        -0.009112
   2          0.010368         -0.028199         0.015570
   3         -0.009761         -0.002566        -0.006458
------------------------------------------------------------

 Torch energy 0.016286 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8349  2.7717 -0.2545
 -1.5662  1.9606  0.1290
 -2.5777  2.5800 -0.7636
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5881
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
  0.8523 -3.3831  1.3998
  -1.1624  3.3578 -1.6248
   0.3102  0.0253  0.2250
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0158813
Custom energy in wrapper 0.0158813
Energy in torch_custom2 =     0.015881 
Gradients:
-0.008523	0.033831	-0.013998	
0.011624	-0.033578	0.016248	
-0.003102	-0.000253	-0.002250	
Forces:
0.008523	-0.033831	0.013998	
-0.011624	0.033578	-0.016248	
0.003102	0.000253	0.002250	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.834907          2.771723        -0.254500
   1         -1.566235          1.960638         0.128954
   1         -2.577655          2.579966        -0.763573
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1         -0.004510          0.017902        -0.007407
   2          0.006151         -0.017769         0.008598
   3         -0.001641         -0.000134        -0.001191
------------------------------------------------------------

 Torch energy 0.015881 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 11 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.834907     2.771723    -0.254500
A02H                -1.566235     1.960638     0.128954
A03H                -2.577655     2.579966    -0.763573
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0091768570
                     LJ ENERGY     0.0008286007

                     ML ENERGY     0.0158812888

                  TOTAL ENERGY     0.0075330325


                 ENERGY CHANGE    -0.0001232931
                  RMS GRADIENT     0.0076324011
              MAXIMUM GRADIENT     0.0155396831


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8474  2.7968 -0.3002
 -1.5555  2.0307  0.1465
 -2.5958  2.5407 -0.7830
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5856
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -0.8350 -3.0286  0.2800
  -0.8663  2.3980 -1.3629
   1.7013  0.6306  1.0829
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0158565
Custom energy in wrapper 0.0158565
Energy in torch_custom2 =     0.015856 
Gradients:
0.008350	0.030286	-0.002800	
0.008663	-0.023980	0.013629	
-0.017013	-0.006306	-0.010829	
Forces:
-0.008350	-0.030286	0.002800	
-0.008663	0.023980	-0.013629	
0.017013	0.006306	0.010829	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.847425          2.796813        -0.300245
   1         -1.555545          2.030743         0.146459
   1         -2.595788          2.540739        -0.782955
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.004419          0.016027        -0.001482
   2          0.004584         -0.012690         0.007212
   3         -0.009003         -0.003337        -0.005730
------------------------------------------------------------

 Torch energy 0.015856 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 12 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.847425     2.796813    -0.300245
A02H                -1.555545     2.030743     0.146459
A03H                -2.595788     2.540739    -0.782955
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0097391727
                     LJ ENERGY     0.0009888193

                     ML ENERGY     0.0158564635

                  TOTAL ENERGY     0.0071061101


                 ENERGY CHANGE    -0.0004269225
                  RMS GRADIENT     0.0062400039
              MAXIMUM GRADIENT     0.0103194466


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8577  2.8068 -0.3131
 -1.5530  2.0646  0.1468
 -2.5971  2.5246 -0.7909
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5696
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -1.2492 -0.6736 -0.7471
   0.1485  0.0739  0.0907
   1.1008  0.5996  0.6565
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0156959
Custom energy in wrapper 0.0156959
Energy in torch_custom2 =     0.015696 
Gradients:
0.012492	0.006736	0.007471	
-0.001485	-0.000739	-0.000907	
-0.011008	-0.005996	-0.006565	
Forces:
-0.012492	-0.006736	-0.007471	
0.001485	0.000739	0.000907	
0.011008	0.005996	0.006565	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.857747          2.806777        -0.313071
   1         -1.553010          2.064597         0.146817
   1         -2.597077          2.524591        -0.790915
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.006611          0.003564         0.003954
   2         -0.000786         -0.000391        -0.000480
   3         -0.005825         -0.003173        -0.003474
------------------------------------------------------------

 Torch energy 0.015696 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 13 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.857747     2.806777    -0.313071
A02H                -1.553010     2.064597     0.146817
A03H                -2.597077     2.524591    -0.790915
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0098968202
                     LJ ENERGY     0.0010599279

                     ML ENERGY     0.0156959444

                  TOTAL ENERGY     0.0068590521


                 ENERGY CHANGE    -0.0002470579
                  RMS GRADIENT     0.0034833109
              MAXIMUM GRADIENT     0.0061088016


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8807  2.8385 -0.3678
 -1.5405  2.1532  0.1646
 -2.6118  2.4774 -0.8129
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5877
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -1.4129 -2.9667  0.0051
  -0.8735  1.8128 -1.3875
   2.2864  1.1539  1.3824
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0158767
Custom energy in wrapper 0.0158767
Energy in torch_custom2 =     0.015877 
Gradients:
0.014129	0.029667	-0.000051	
0.008735	-0.018128	0.013875	
-0.022864	-0.011539	-0.013824	
Forces:
-0.014129	-0.029667	0.000051	
-0.008735	0.018128	-0.013875	
0.022864	0.011539	0.013824	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.880674          2.838532        -0.367847
   1         -1.540506          2.153236         0.164617
   1         -2.611823          2.477410        -0.812919
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.007477          0.015699        -0.000027
   2          0.004622         -0.009593         0.007343
   3         -0.012099         -0.006106        -0.007315
------------------------------------------------------------

 Torch energy 0.015877 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 14 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.880674     2.838532    -0.367847
A02H                -1.540506     2.153236     0.164617
A03H                -2.611823     2.477410    -0.812919
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0104631855
                     LJ ENERGY     0.0012877011

                     ML ENERGY     0.0158767048

                  TOTAL ENERGY     0.0067012204


                 ENERGY CHANGE    -0.0001578317
                  RMS GRADIENT     0.0067999463
              MAXIMUM GRADIENT     0.0111257666


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8821  2.8352 -0.3582
 -1.5432  2.1445  0.1587
 -2.6050  2.4838 -0.8095
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5674
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.001 *
 -3.5464 -9.3371  0.5025
  -0.7607  5.4260 -2.5431
   4.3071  3.9111  2.0406
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0156744
Custom energy in wrapper 0.0156744
Energy in torch_custom2 =     0.015674 
Gradients:
0.003546	0.009337	-0.000503	
0.000761	-0.005426	0.002543	
-0.004307	-0.003911	-0.002041	
Forces:
-0.003546	-0.009337	0.000503	
-0.000761	0.005426	-0.002543	
0.004307	0.003911	0.002041	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.882119          2.835166        -0.358150
   1         -1.543159          2.144522         0.158719
   1         -2.604957          2.483829        -0.809456
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.001877          0.004941        -0.000266
   2          0.000403         -0.002871         0.001346
   3         -0.002279         -0.002070        -0.001080
------------------------------------------------------------

 Torch energy 0.015674 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 15 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.882119     2.835166    -0.358150
A02H                -1.543159     2.144522     0.158719
A03H                -2.604957     2.483829    -0.809456
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0103758835
                     LJ ENERGY     0.0012666028

                     ML ENERGY     0.0156744085

                  TOTAL ENERGY     0.0065651278


                 ENERGY CHANGE    -0.0001360926
                  RMS GRADIENT     0.0009572997
              MAXIMUM GRADIENT     0.0018949577


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.8956  2.8492 -0.3780
 -1.5389  2.1848  0.1623
 -2.6068  2.4639 -0.8184
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5677
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.001 *
 -0.7217 -10.2150  3.2120
  -1.7440  6.9992 -4.0387
   2.4657  3.2158  0.8268
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0156769
Custom energy in wrapper 0.0156769
Energy in torch_custom2 =     0.015677 
Gradients:
0.000722	0.010215	-0.003212	
0.001744	-0.006999	0.004039	
-0.002466	-0.003216	-0.000827	
Forces:
-0.000722	-0.010215	0.003212	
-0.001744	0.006999	-0.004039	
0.002466	0.003216	0.000827	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.895552          2.849230        -0.377955
   1         -1.538941          2.184755         0.162317
   1         -2.606778          2.463928        -0.818405
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.000382          0.005406        -0.001700
   2          0.000923         -0.003704         0.002137
   3         -0.001305         -0.001702        -0.000438
------------------------------------------------------------

 Torch energy 0.015677 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 16 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.895552     2.849230    -0.377955
A02H                -1.538941     2.184755     0.162317
A03H                -2.606778     2.463928    -0.818405
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0105762187
                     LJ ENERGY     0.0013779002

                     ML ENERGY     0.0156769082

                  TOTAL ENERGY     0.0064785897


                 ENERGY CHANGE    -0.0000865381
                  RMS GRADIENT     0.0009552934
              MAXIMUM GRADIENT     0.0015903190


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.9211  2.8785 -0.4062
 -1.5317  2.2557  0.1643
 -2.6067  2.4267 -0.8342
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5787
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.01 *
 -0.8923 -2.7168  0.2355
  -0.2776  1.4019 -0.7633
   1.1699  1.3149  0.5279
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0157871
Custom energy in wrapper 0.0157871
Energy in torch_custom2 =     0.015787 
Gradients:
0.008923	0.027168	-0.002355	
0.002776	-0.014019	0.007633	
-0.011699	-0.013149	-0.005279	
Forces:
-0.008923	-0.027168	0.002355	
-0.002776	0.014019	-0.007633	
0.011699	0.013149	0.005279	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.921094          2.878465        -0.406189
   1         -1.531716          2.255719         0.164269
   1         -2.606707          2.426697        -0.834219
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.004722          0.014377        -0.001246
   2          0.001469         -0.007418         0.004039
   3         -0.006191         -0.006958        -0.002793
------------------------------------------------------------

 Torch energy 0.015787 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 17 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.921094     2.878465    -0.406189
A02H                -1.531716     2.255719     0.164269
A03H                -2.606707     2.426697    -0.834219
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0109977077
                     LJ ENERGY     0.0016473486

                     ML ENERGY     0.0157871041

                  TOTAL ENERGY     0.0064367450


                 ENERGY CHANGE    -0.0000418447
                  RMS GRADIENT     0.0043046824
              MAXIMUM GRADIENT     0.0082594356


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.9171  2.8716 -0.3944
 -1.5335  2.2372  0.1609
 -2.6035  2.4374 -0.8301
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5694
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.001 *
 -4.7458 -12.7759  0.4627
   1.9804  5.8999 -0.3952
   2.7654  6.8760 -0.0675
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0156941
Custom energy in wrapper 0.0156941
Energy in torch_custom2 =     0.015694 
Gradients:
0.004746	0.012776	-0.000463	
-0.001980	-0.005900	0.000395	
-0.002765	-0.006876	0.000067	
Forces:
-0.004746	-0.012776	0.000463	
0.001980	0.005900	-0.000395	
0.002765	0.006876	-0.000067	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.917071          2.871590        -0.394373
   1         -1.533541          2.237227         0.160862
   1         -2.603500          2.437368        -0.830065
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.002511          0.006761        -0.000245
   2         -0.001048         -0.003122         0.000209
   3         -0.001463         -0.003639         0.000036
------------------------------------------------------------

 Torch energy 0.015694 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 18 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.917071     2.871590    -0.394373
A02H                -1.533541     2.237227     0.160862
A03H                -2.603500     2.437368    -0.830065
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0108954076
                     LJ ENERGY     0.0015890812

                     ML ENERGY     0.0156941190

                  TOTAL ENERGY     0.0063877926


                 ENERGY CHANGE    -0.0000489524
                  RMS GRADIENT     0.0008953148
              MAXIMUM GRADIENT     0.0016619642


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.9238  2.8771 -0.3988
 -1.5315  2.2520  0.1607
 -2.6023  2.4307 -0.8335
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5688
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.001 *
 -3.2892 -11.6512  1.2027
   1.6407  5.7373 -0.5739
   1.6484  5.9139 -0.6288
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0156879
Custom energy in wrapper 0.0156879
Energy in torch_custom2 =     0.015688 
Gradients:
0.003289	0.011651	-0.001203	
-0.001641	-0.005737	0.000574	
-0.001648	-0.005914	0.000629	
Forces:
-0.003289	-0.011651	0.001203	
0.001641	0.005737	-0.000574	
0.001648	0.005914	-0.000629	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.923803          2.877144        -0.398833
   1         -1.531517          2.251999         0.160690
   1         -2.602266          2.430674        -0.833513
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.001741          0.006166        -0.000636
   2         -0.000868         -0.003036         0.000304
   3         -0.000872         -0.003129         0.000333
------------------------------------------------------------

 Torch energy 0.015688 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 19 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.923803     2.877144    -0.398833
A02H                -1.531517     2.251999     0.160690
A03H                -2.602266     2.430674    -0.833513
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0109590124
                     LJ ENERGY     0.0016431382

                     ML ENERGY     0.0156878792

                  TOTAL ENERGY     0.0063720050


                 ENERGY CHANGE    -0.0000157876
                  RMS GRADIENT     0.0006630129
              MAXIMUM GRADIENT     0.0013525570


marker for calling opt_step
state->task: FG_LNSRCH                                                   ÿÿÿÿFG                                                          
strlen("FG"): 2


================= TEST FOR CUSTOM MODEL=====================
=============TORCH ELPOT=============
    0.030938     0.030938
    0.016296     0.016296
    0.030128     0.030128
====================================
Species Tensor Shape: [1, 3]
Coordinates Tensor Shape: [1, 3, 3]
Elecpots Tensor Shape: [1, 3]
Species Data:  3  0  0
[ CPULongType{1,3} ]
Coordinates Data: (1,.,.) = 
 -1.9410  2.8915 -0.4068
 -1.5253  2.2885  0.1597
 -2.5988  2.4140 -0.8433
[ CPUFloatType{1,3,3} ]
Elecpots Data: 0.01 *
 3.0938  1.6296  3.0128
[ CPUFloatType{1,3} ]
Energy: 0.01 *
 1.5685
[ CPUFloatType{1} ]
Force: (1,.,.) = 
 0.001 *
 -5.7148 -11.4908 -1.4320
   0.8410  4.4011 -0.6601
   4.8738  7.0897  2.0921
[ CPUFloatType{1,3,3} ]
Custom Energy: 0.0156848
Custom energy in wrapper 0.0156848
Energy in torch_custom2 =     0.015685 
Gradients:
0.005715	0.011491	0.001432	
-0.000841	-0.004401	0.000660	
-0.004874	-0.007090	-0.002092	
Forces:
-0.005715	-0.011491	-0.001432	
0.000841	0.004401	-0.000660	
0.004874	0.007090	0.002092	

 TORCH INFO 
-----------

 Special fragment coordinates (Angstroms) 
-----------------------------------------------------------
  Atom            X                 Y                Z
   8         -1.941003          2.891495        -0.406848
   1         -1.525291          2.288503         0.159683
   1         -2.598818          2.414050        -0.843282
-----------------------------------------------------------

 Special fragment atom gradients 
-----------------------------------------------------------
  Atom            X                 Y                Z
   1          0.003024          0.006081         0.000758
   2         -0.000445         -0.002329         0.000349
   3         -0.002579         -0.003752        -0.001107
------------------------------------------------------------

 Torch energy 0.015685 

================= END OF TEST FOR CUSTOM MODEL=====================

first (FG) if block in opt_step
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("FG"): 2
state->task: NEW_X                                                       ÿÿÿÿCONVERGENCE                                                 
strlen("NEW_X"): 5
second (NEW_X) if block in opt_step
marker for calling in opt_get_fx
marker for calling in opt_get_x
marker for calling in opt_get_gx
    STATE AFTER 20 STEPS

    GEOMETRY (ANGSTROMS)

A01O                -1.941003     2.891495    -0.406848
A02H                -1.525291     2.288503     0.159683
A03H                -2.598818     2.414050    -0.843282
A01O                -1.815220     5.663988    -0.000000
A02H                -1.617480     4.725461     0.001936
A03H                -2.476026     5.736906    -0.714908


    ENERGY COMPONENTS (ATOMIC UNITS)

          ELECTROSTATIC ENERGY     0.0000000000
           POLARIZATION ENERGY     0.0000000000
             DISPERSION ENERGY     0.0000000000
     EXCHANGE REPULSION ENERGY     0.0000000000
          POINT CHARGES ENERGY     0.0000000000
     CHARGE PENETRATION ENERGY     0.0000000000
                     QQ ENERGY    -0.0111267491
                     LJ ENERGY     0.0017945099

                     ML ENERGY     0.0156847890

                  TOTAL ENERGY     0.0063525499


                 ENERGY CHANGE    -0.0000194552
                  RMS GRADIENT     0.0011188003
              MAXIMUM GRADIENT     0.0020320158


ENERGY MINIMIZATION JOB COMPLETED SUCCESSFULLY
WALL CLOCK TIME IS Tue Oct  8 04:35:58 2024
TOTAL RUN TIME IS 5 SECONDS
